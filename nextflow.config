process.container = 'ubuntu:21.04'
docker.enabled = true

params.ci_run = false

// enable tower by default, except when ci_run is true
tower {
  enabled = (params.ci_run == true ? false : true)
  accessToken = "$NF_TOWER_TOKEN"
}

process{
  withLabel: many_cpu_intensive {
    cpus = 2
    memory = 4.GB
  }
  withLabel: many_cpu_medium {
    cpus = 1
    memory = 4.GB
  }
  withLabel: few_memory_intensive {
    cpus = (params.ci_run == true ? 2 : 8)
    memory = 16.GB
  }
}

params{
  tidehunter{
    headerlines         = "readName\trepN\tcopyNum\treadLen\tstart\tend\tconsLen\taveMatch\tfullLen\tsubPos\tconsSeq"
    headerlinesQual     = "readName\trepN\tcopyNum\treadLen\tstart\tend\tconsLen\taveMatch\tfullLen\tsubPos\tconsSeq\tquality"
    minimum_match_ratio = 0.4
    minimum_period      = 60
    minimum_copy        = 3
    kmer_length         = 16
    primer_length       = 10
  }
}

executor {
  $local {
      cpus = 15
      memory = '28 GB'
  }
}
